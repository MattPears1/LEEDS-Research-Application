---
#########################################
# options for knitting a single chapter #
#########################################
output:
  bookdown::pdf_document2:
    template: templates/template.tex
  bookdown::html_document2: default
  bookdown::word_document2: default
documentclass: book
#bibliography: [bibliography/references.bib, bibliography/additional-references.bib]
---

```{block type='savequote', quote_author='(ref:cicero-quote)', include=knitr::is_latex_output()}
Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit...

There is no one who loves pain itself, who seeks after it and wants to have it, simply because it is pain...
```

(ref:cicero-quote) --- Cicero's *de Finibus Bonorum et Malorum*.

```{=html}
<!-- 
Notes for adding an opening quote in PDF output:
i) add the reference for the quote with the chunk option quote_author="my author name",
ii) include=knitr::opts_knit$get('rmarkdown.pandoc.to') == 'latex' means that these quotes are only included when output is latex (in HTML output, it would appear by the end of the previous page)
iii) You can't use markdown syntax inside chunk options, so if you want to e.g. italicise a book name in the quote reference use a 'text reference': Create a named piece of text with '(ref:label-name) My text', then link to this in the chunk option with quote_author='(ref:label-name)'
-->
```


# Results {#rmd-basics}

\minitoc <!-- this will include a mini table of contents-->

<!-- LaTeX normally does not indent the first line after a heading - however, it does so after the mini table of contents. You can manually tell it not to with \noindent -->

\noindent 
## Chatbot Usabilty Questionanire (CUQ)

### CUQ Calcuation tool

The CUQ was developed by researchers at Ulster University (see)
[](){<a href="https://www.ulster.ac.uk/research/topic/computer-science/artificial-intelligence/projects/cuq" target="_blank">CUQ</a>}) and as the calculation can be complex a dedicated calculation tool has been created. 

Please download the CEPEH CUQ calculation tool which has all of the data entered, so you can see the CEPEH CUQ scoring. 

[click here to download CUQ calc tool](CUQ-Calculation-Tool.xlsx)


The results are as followed:

```{r cuq}

knitr::include_graphics("cuq.png")

```

This scoring system was designed to be comparable to SUS and may be freely used alongside it, or in combination with other usability metrics. There has been evidence of correlation of 76% between the CUQ and SUS therefore we expect the SUS scored to be between 48.75 and 81%.  We believe the CUQ has more validity towards measuring the concepts of interest on this study. 



```{r Importing Data 2, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)

required_packages <- c("rmarkdown", "bookdown", "knitr", "kableExtra", "tidyverse", "here", "readxl", "ggplot2", "lubridate", "plotly", "dplyr", "wesanderson", "viridis","leaflet")

for (package in required_packages) {
  print(paste0("checking for install of ", package))
  if (!requireNamespace(package)) install.packages(package, repos = "http://cran.rstudio.com")
}

library(readxl)
library(ggplot2)
library(lubridate)
library(plotly)
library(dplyr)
#color pallets
library(wesanderson)
library(viridis)
library(knitr)
library(tidyverse)
library(leaflet)
library(excelR)


try(data <- read_excel("C:/Users/MattP/Desktop/Full DATA CEPEH moh.xlsx"))


Sex <- data$Sex
Sex <- data.frame(Sex)

disc <- subset(data, select = "Location")
disc <- na.omit(disc)
colnames(disc)[1] = "Location"



```



##	System Usability Scale (SUS) Scores	

*Note= The amount of ‘agreement’ is defined as the addition of ‘Agree’ and ‘Strongly agree’ responses.*

The SUS score for all data was XXX. This is within, and above the median of, 68 – which is in the range of ‘average’ usability. This is good as the resources were early demonstrations and had reduced beta alpha testing due to time constraints- future updates can improve this metric.

After reversing the scores of the negatively worded questions (odd numbered questions), participants strongly agreed the system was not complex (XX% agreements), and they did not need assistance before use (XX% agreements). All remaining questions has the most frequently observed response as ‘agree’- the lowest amount of agreement (agree and strongly agree) was XX% for question X, which was explored further in the individual Partners’ analyses. 



```{r SUS table 1, echo=FALSE, message=FALSE, warning=FALSE, comment=NA, paged.print=FALSE}

sus <- subset(data, select = c("Profession"))
sus <- na.omit(sus)

knitr::kable(sus <-sus %>% filter(Profession %in% c("Student on a Healthcare course","College student", "Medical doctor","Learning Technologist", "Mature Student", "Lecturer", format('html'))) %>% group_by(Profession) %>% count(Profession),"pipe")

```


```{r graphs2, eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}

ggplot(year, aes(year)) + geom_bar(color="purple", fill=rgb(0.2,0.3,0.9,0.7) ) + scale_x_continuous(breaks = seq(2006, 2022,1)) + theme(plot.title = element_text(face="bold.italic"))
```




```{r Recommend table 1, eval=FALSE, message=FALSE, warning=FALSE, comment=NA, include=FALSE, paged.print=TRUE}

rec <- subset(data, select = c("Recommend","Identity"))
rec <- na.omit(rec)

knitr::kable(rec <-rec %>% filter(Identity == c("HE student","Healthcare professional", "Other", "Student","Tutor/Teacher/Lecturer","Patient/Service-user/Carer",format('html'))) %>% group_by(Identity, Recommend) %>% count(Recommend), "pipe")


```


```{r Helpful table 1, eval=FALSE, message=FALSE, warning=FALSE, comment=NA, include=FALSE, paged.print=TRUE}

RLO <- subset(data, select = c("Identity","RLO Helpful"))
RLO <- na.omit(RLO)
colnames(RLO)[2] = "RLO" 
knitr::kable(RLO <- RLO %>% filter(Identity == c("HE student","Healthcare professional", "Other", format('html'), "Student","Tutor/Teacher/Lecturer", "Patient/Service-user/Carer")) %>% group_by(Identity, RLO) %>% count(RLO), "pipe")

```

if you don't like boring tables, here is the same data in a graph!

```{r barplot, eval=FALSE, include=FALSE}
# stacked horizontal bar plot of RLO X identity 
##dataset RLOk 
RLOk <- na.omit(RLO) 

## the bar plot
ggplot(RLOk, aes(fill = RLO, x = Identity)) + geom_bar(width=0.5,position = "fill") + coord_flip() + ggtitle("How helpful has this learning object been?") + theme(plot.title = element_text(face="bold.italic")) + ylab("Scale of how helpful (0-1) ") + xlab("") + scale_fill_viridis(discrete = TRUE,option = "D") 

```





## Technology Acceptance Model

The TAM had 3 sections (Ease of Use, Perceived Usefulness, and Intention of Use). Ease of Use results showed significant increases in Users’ usage with each Chatbot. Perceived Usefulness: There were not significant findings for the Perceived usefulness. The justification for this may be due to being early versions of applications with limited functionality and functions which can be difficult for user to experience the intended further range of features and learning exercises. 

Intention of Use: For users’ intentions to use within their course, the result of the Mann-Whitney U test was not significant, U = , z = , p = . in their intentions before use (m=xx, mode=xx) compared to after (m=xx, mode=x), however there was improvement therefore the chatbots may have more benefit than expected by students. 




### Other Findings

Other questions

I intend to continue using chatbots in the future (BI1)	

The chatbot provided the information I needed with minimal commands	

My knowledge of the topic improved after i had used the Chatbot	

My confidence in understanding the topic improved after I had used the Chatbot	

The chatbot provided me with the type of response i expected from asking a tutor/lecturer	 

The information provided was reliable 

The chatbot has a high level of trustworthiness	

The duration of conversations to find my answer was too long	

The videos/images provided were useful to my questions

The chatbot exceeded my expectation of how it could help me	

The chatbot exceeded my expectation of how it could engage with me

I think this learning method could help me to acquire knowledge	

I would use this tool again as it has some value to me	

I think i will actively use this learning method	

I believe i had some choice about learning during chatbot use	

I would trust the chatbot to provide me with information for my course

One piece of knowledge i learned from the chatbot was..



```{r second setup stuff 3, message=FALSE, warning=FALSE, comment=NA, include=FALSE, paged.print=FALSE}

library(readxl)
library(ggplot2)
library(lubridate)
library(plotly)
library(dplyr)
#color pallets
library(wesanderson)
library(viridis)
library(knitr)
library(tidyverse)


```

```{r Discovery Section, eval=FALSE, message=FALSE, warning=FALSE, comment=NA, include=FALSE, paged.print=FALSE}

# horizontal bar plot of Discovery
## dataset disc2
disc2 <- disc %>% filter(dRLO == c("Other", "It was a course learning resource", "General internet search", "Recommended by a colleague/peer","Through HELM-Open")) 

##bar plot of discovery
ggplot(disc2, aes(dRLO)) + geom_bar(width = 0.5, fill = "darkblue") + theme_minimal() + ggtitle("How did you find out about the RLO you used?") + theme(plot.title = element_text(hjust = -1.5, face = "bold.italic")) + coord_flip() + ylab("Number of respondents") + xlab(" ")
```


UP TO HERE1


```{r Discovery section 2, eval=FALSE, message=FALSE, warning=FALSE, comment=NA, include=FALSE, paged.print=FALSE}

# A Table showing Identity X Discovery of RLO X NFrequency
disc3 <- subset(data, select = c("Identity","Discover RLO"))

colnames(disc3)[2] <- "dRLO"

disc3 <- disc3 %>% filter(dRLO == c("Other", "It was a course learning resource", "General internet search", "Recommended by a colleague/peer","Through HELM-Open"))

```

