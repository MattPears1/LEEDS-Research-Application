---
#########################################
# options for knitting a single chapter #
#########################################
output:
  bookdown::pdf_document2:
    template: templates/template.tex
  bookdown::html_document2: default
  bookdown::word_document2: default
documentclass: book
#bibliography: [bibliography/references.bib, bibliography/additional-references.bib]
---

```{block type='savequote', quote_author='(ref:cicero-quote)', include=knitr::is_latex_output()}
Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit...

There is no one who loves pain itself, who seeks after it and wants to have it, simply because it is pain...
```

(ref:cicero-quote) --- Cicero's *de Finibus Bonorum et Malorum*.

```{=html}
<!-- 
Notes for adding an opening quote in PDF output:
i) add the reference for the quote with the chunk option quote_author="my author name",
ii) include=knitr::opts_knit$get('rmarkdown.pandoc.to') == 'latex' means that these quotes are only included when output is latex (in HTML output, it would appear by the end of the previous page)
iii) You can't use markdown syntax inside chunk options, so if you want to e.g. italicise a book name in the quote reference use a 'text reference': Create a named piece of text with '(ref:label-name) My text', then link to this in the chunk option with quote_author='(ref:label-name)'
-->
```






# Results {#rmd-basics}

\minitoc <!-- this will include a mini table of contents-->

<!-- LaTeX normally does not indent the first line after a heading - however, it does so after the mini table of contents. You can manually tell it not to with \noindent -->

\noindent 

Have users in previous years shared the HELM Open RLO catalogue?

Well, we have so much data we haven't looked through it all yet.

33,571 learners told us how they found out- each answer is different.

We are through about 10% of this data and will update weekly.




```{r Importing Data 2, message=FALSE, warning=FALSE, include=FALSE, paged.print=TRUE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)

required_packages <- c("rmarkdown", "bookdown", "knitr", "kableExtra", "tidyverse", "here", "readxl", "ggplot2", "lubridate", "plotly", "dplyr", "wesanderson", "viridis","leaflet")

for (package in required_packages) {
  print(paste0("checking for install of ", package))
  if (!requireNamespace(package)) install.packages(package, repos = "http://cran.rstudio.com")
}

library(readxl)
library(ggplot2)
library(lubridate)
library(plotly)
library(dplyr)
#color pallets
library(wesanderson)
library(viridis)
library(knitr)
library(tidyverse)
library(leaflet)

try(data <- read_excel("C:/Users/MattP/Desktop/Full DATA CEPEH.xlsx"))

Sex <- data$Sex
Sex <- data.frame(Sex)

disc <- subset(data, select = "Location")
disc <- na.omit(disc)
colnames(disc)[1] = "Location"
```


## Pre Usage Results


```{r PRE Usage table 1, echo=FALSE, message=FALSE, warning=FALSE, comment=NA, paged.print=TRUE}

pre <- subset(data, select = c("What is your profession","Previous Chatbot Usage"))
pre <- na.omit(pre)
colnames(pre)[1] = "profession"
colnames(pre)[2] = "hours"


library(kableExtra)

print(pre) %>% 
  kable(booktabs = TRUE)


```



##	System Usability Scale (SUS) Scores	

*Note= The amount of ‘agreement’ is defined as the addition of ‘Agree’ and ‘Strongly agree’ responses.*

The SUS score for all data was XXX. This is within, and above the median of, 68 – which is in the range of ‘average’ usability. This is good as the resources were early demonstrations and had reduced beta alpha testing due to time constraints- future updates can improve this metric.


After reversing the scores of the negatively worded questions (odd numbered questions), participants strongly agreed the system was not complex (XX% agreements), and they did not need assistance before use (XX% agreements). All remaining questions has the most frequently observed response as ‘agree’- the lowest amount of agreement (agree and strongly agree) was XX% for question X, which was explored further in the individual Partners’ analyses. 







```{r SUS table 1, eval=FALSE, message=FALSE, warning=FALSE, comment=NA, include=FALSE, paged.print=TRUE}

sus <- subset(data, select = c("Recommend","Identity"))
sus <- na.omit(rec)

knitr::kable(rec <-rec %>% filter(Identity == c("HE student","Healthcare professional", "Other", "Student","Tutor/Teacher/Lecturer","Patient/Service-user/Carer",format('html'))) %>% group_by(Identity, Recommend) %>% count(Recommend), "pipe")

```


```{r graphs2, eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}

ggplot(year, aes(year)) + geom_bar(color="purple", fill=rgb(0.2,0.3,0.9,0.7) ) + scale_x_continuous(breaks = seq(2006, 2022,1)) + theme(plot.title = element_text(face="bold.italic"))
```







```{r Recommend table 1, eval=FALSE, message=FALSE, warning=FALSE, comment=NA, include=FALSE, paged.print=TRUE}

rec <- subset(data, select = c("Recommend","Identity"))
rec <- na.omit(rec)

knitr::kable(rec <-rec %>% filter(Identity == c("HE student","Healthcare professional", "Other", "Student","Tutor/Teacher/Lecturer","Patient/Service-user/Carer",format('html'))) %>% group_by(Identity, Recommend) %>% count(Recommend), "pipe")


```


```{r Helpful table 1, eval=FALSE, message=FALSE, warning=FALSE, comment=NA, include=FALSE, paged.print=TRUE}

RLO <- subset(data, select = c("Identity","RLO Helpful"))
RLO <- na.omit(RLO)
colnames(RLO)[2] = "RLO" 
knitr::kable(RLO <- RLO %>% filter(Identity == c("HE student","Healthcare professional", "Other", format('html'), "Student","Tutor/Teacher/Lecturer", "Patient/Service-user/Carer")) %>% group_by(Identity, RLO) %>% count(RLO), "pipe")

```

if you don't like boring tables, here is the same data in a graph!

```{r barplot, eval=FALSE, include=FALSE}
# stacked horizontal bar plot of RLO X identity 
##dataset RLOk 
RLOk <- na.omit(RLO) 

## the bar plot
ggplot(RLOk, aes(fill = RLO, x = Identity)) + geom_bar(width=0.5,position = "fill") + coord_flip() + ggtitle("How helpful has this learning object been?") + theme(plot.title = element_text(face="bold.italic")) + ylab("Scale of how helpful (0-1) ") + xlab("") + scale_fill_viridis(discrete = TRUE,option = "D") 

```





## Technology Acceptance Model

The TAM had 3 sections (Ease of Use, Perceived Usefulness, and Intention of Use). Ease of Use results showed significant increases in Users’ usage with each Chatbot. Perceived Usefulness: There were not significant findings for the Perceived usefulness. The justification for this may be due to being early versions of applications with limited functionality and functions which can be difficult for user to experience the intended further range of features and learning exercises. 
Intention of Use: For users’ intentions to use within their course, the result of the Mann-Whitney U test was not significant, U = , z = , p = . in their intentions before use (m=xx, mode=xx) compared to after (m=xx, mode=x), however there was improvement therefore the chatbots may have more benefit than expected by students. 


















### Course Learning, Recommendations, and more

The data showed that learners *strongly recommend* the RLO(s) they used to others, but how does this translate?

For the 10% of data we have, the figure below '*How did you find out about the RLO you used'* shows 700 respondents were recommended from a friend, peer, tutor, or other.

```{r second setup stuff, message=FALSE, warning=FALSE, comment=NA, include=FALSE, paged.print=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)

required_packages <- c("rmarkdown", "bookdown", "knitr", "kableExtra", "tidyverse", "here", "readxl", "ggplot2", "lubridate", "plotly", "dplyr", "wesanderson", "viridis")

for (package in required_packages) {
  print(paste0("checking for install of ", package))
  if (!requireNamespace(package)) install.packages(package, repos = "http://cran.rstudio.com")
}

library(readxl)
library(ggplot2)
library(lubridate)
library(plotly)
library(dplyr)
#color pallets
library(wesanderson)
library(viridis)
library(knitr)
library(tidyverse)
try(data <- read_excel("C:/Users/MattP/Desktop/HELM data final.xlsx"))

year <- data$Year
year <- data.frame(year)
disc <- subset(data, select = "Discover RLO")
disc <- na.omit(disc)
colnames(disc)[1] = "dRLO"
df<-data
```

```{r Discovery Section, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, comment=NA}

# horizontal bar plot of Discovery
## dataset disc2
disc2 <- disc %>% filter(dRLO == c("Other", "It was a course learning resource", "General internet search", "Recommended by a colleague/peer","Through HELM-Open")) 

##bar plot of discovery
ggplot(disc2, aes(dRLO)) + geom_bar(width = 0.5, fill = "darkblue") + theme_minimal() + ggtitle("How did you find out about the RLO you used?") + theme(plot.title = element_text(hjust = -1.5, face = "bold.italic")) + coord_flip() + ylab("Number of respondents") + xlab(" ")
```

This figure also shows how more than 6000 respondents first used the RLOs as instructed by their tutors on their course.

and if you're browsing the internet for information on a healthcare topic and come across <https://www.nottingham.ac.uk/helmopen/> :- You're 1 of about 350 people finding about our resources from internet search.
Hopefully that grows, but it seems social networking is the key to sharing these tools.

A random sample of other sources are: Twitter, Aim higher days, Barnardos ignite learning, and, well, '*a random Google photo*;'- our online presence seems to be in many places!

UP TO HERE1

```{r Discovery section 2, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, comment=NA}

# A Table showing Identity X Discovery of RLO X NFrequency
disc3 <- subset(data, select = c("Identity","Discover RLO"))

colnames(disc3)[2] <- "dRLO"

disc3 <- disc3 %>% filter(dRLO == c("Other", "It was a course learning resource", "General internet search", "Recommended by a colleague/peer","Through HELM-Open"))

```


```{r Identity section 1, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, comment=NA}
disc3 <- na.omit(disc3) 

disc3 %>% filter(Identity == c("HE student","Healthcare professional", "Other", "Student","Tutor/Teacher/Lecturer", "Patient/Service-user/Carer")) %>% group_by(Identity, dRLO) %>% count(dRLO)

ggplot(disc3, aes(fill = dRLO, x = Identity)) + geom_bar(width=0.5,position = "fill")
view(disc3)

ggplot(disc3, aes(fill = dRLO, x = dRLO)) + geom_bar(width=0.5,position = "fill") + coord_flip() + ggtitle("How helpful has this learning object been?") + theme(plot.title = element_text(face="bold.italic")) + ylab("Percent of each response") + xlab("") + scale_fill_manual(values = wes_palette("BottleRocket1", n = 6)) 

disc3 %>% filter(Identity == c("HE student","Healthcare professional", "Other", "Student","Tutor/Teacher/Lecturer", "Patient/Service-user/Carer")) %>% group_by(Identity, dRLO) %>% count(dRLO) 

disc3 <- disc3 %>% filter(Identity == c("HE student","Healthcare professional", "Other", "Student","Tutor/Teacher/Lecturer", "Patient/Service-user/Carer")) %>% group_by(Identity, dRLO) %>% count(dRLO)

# stacked horizontal bar chart dRLO X discovery
ggplot(disc3, aes(fill = dRLO, x = Identity)) + geom_bar(width=0.5,position = "fill") + coord_flip() + ggtitle("How did you find out about this resource?") + theme(plot.title = element_text(face="bold.italic")) + ylab("Percent of each response") + xlab("") + scale_fill_manual(values = wes_palette("BottleRocket1", n = 6)) 

```

### Italics and bold

-   *Italics* are done like \*this\* or \_this\_
-   **Bold** is done like \*\*this\*\* or \_\_this\_\_
-   ***Bold and italics*** is done like \*\*\*this\*\*\*, \_\_\_this\_\_\_, or (the most transparent solution, in my opinion) \*\*\_this\_\*\*





### Hyperlinks

-   [This is a hyperlink](https://www.google.com) created by writing the text you want turned into a clickable link in `[square brackets followed by a](https://hyperlink-in-parentheses)`

### Footnotes

-   Are created[^02-rmd-basics-markdown-1] by writing either \^[my footnote text] for supplying the footnote content inline, or something like `[^a-random-footnote-label]` and supplying the text elsewhere in the format shown below [^02-rmd-basics-markdown-2]:

[^02-rmd-basics-markdown-1]: my footnote text

[^02-rmd-basics-markdown-2]: This is a random test.

`[^a-random-footnote-label]: This is a random test.`

### Comments

To write comments within your text that won't actually be included in the output, use the same syntax as for writing comments in HTML.
That is, <!-- this will not be included in the output -->.

<!-- It is super useful to use comments! -->




```{r chunk-parts, echo=FALSE, fig.cap="Code chunk syntax", fig.pos='H', message=FALSE, out.width="100%"}
library(tidyverse)
knitr::include_graphics("figures/sample-content/chunk-parts.png")
```




Code chunks are also used for including images, with `include_graphics` from the `knitr` package, as in Figure \@ref(fig:oxford-logo)

```{r oxford-logo, fig.cap="Oxford logo", out.width='50%', fig.align='center'}
knitr::include_graphics("templates/download.png")
```

Useful chunk options for figures include:

-   `out.width` (use with a percentage) for setting the image size
-   if you've got an image that gets waaay to big in your output, it will be constrained to the page width by setting `out.width = "100%"`

#### Figure rotation {.unnumbered}

You can use the chunk option `out.extra` to rotate images.

The syntax is different for LaTeX and HTML, so for ease we might start by assigning the right string to a variable that depends on the format you're outputting to:

```{r}
if (knitr::is_latex_output()){
  rotate180 <- "angle=180"
} else {
  rotate180 <- "style='transform:rotate(180deg);'"
}
```

Then you can reference that variable as the value of `out.extra` to rotate images, as in Figure \@ref(fig:oxford-logo-rotated).

```{r oxford-logo-rotated, out.extra=rotate180, fig.cap="Oxford logo, rotated", out.width='50%', fig.align='center', echo=FALSE}
knitr::include_graphics("templates/download.png")
```

### Including plots

Similarly, code chunks are used for including dynamically generated plots.
You use ordinary code in R or other languages - Figure \@ref(fig:cars-plot) shows a plot of the `cars` dataset of stopping distances for cars at various speeds (this dataset is built in to **R**).

```{r cars-plot, fig.cap = "A ggplot of car stuff"}
cars %>% 
  ggplot() +
    aes(x = speed, y = dist) +
    geom_point()
```

Under the hood, plots are included in your document in the same way as images - when you build the book or knit a chapter, the plot is automatically generated from your code, saved as an image, then included into the output document.

### Including tables

Tables are usually included with the `kable` function from the `knitr` package.

Table \@ref(tab:cars-table) shows the first rows of that cars data - read in your own data, then use this approach to automatically generate tables.

```{r cars-table}
cars %>% 
  head() %>% 
  knitr::kable(caption = "A knitr kable table")
```

-   Gotcha: when using [`kable`](https://www.rdocumentation.org/packages/knitr/versions/1.21/topics/kable), captions are set inside the `kable` function
-   The `kable` package is often used with the [`kableExtra`](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html) package

### Control positioning

One thing that may be annoying is the way *R Markdown* handles "floats" like tables and figures.
In your PDF output, LaTeX will try to find the best place to put your object based on the text around it and until you're really, truly done writing you should just leave it where it lies.

In general, you should allow LaTeX to do this, but if you really *really* need a figure to be positioned where you put in the document, then you can make LaTeX attempt to do this with the chunk option `fig.pos="H"`, as in Figure \@ref(fig:oxford-logo-controlled):

```{r oxford-logo-controlled, fig.cap="An Oxford logo that LaTeX will try to place at this position in the text", out.width='50%', fig.align='center', fig.pos="H"}
knitr::include_graphics("figures/sample-content/beltcrest.png")
```

As anyone who has tried to manually play around with the placement of figures in a Word document knows, this can have lots of side effects with extra spacing on other pages, etc.
Therefore, it is not generally a good idea to do this - only do it when you really need to ensure that an image follows directly under text where you refer to it (in this document, I needed to do this for Figure \@ref(fig:latex-font-sizing) in section \@ref(max-power)).
For more details, read the relevant section of the [R Markdown Cookbook](https://bookdown.org/yihui/rmarkdown-cookbook/figure-placement.html).

## Executable inline code

'Inline code' simply means inclusion of code inside text.
The syntax for doing this is ``` ``r ''`r R_CODE` ``` For example, ``` ``r ''`r 4 + 4` ``` will output `r 4 + 4` in your text.

You will usually use this in parts of your thesis where you report results - read in data or results in a code chunk, store things you want to report in a variable, then insert the value of that variable in your text.
For example, we might assign the number of rows in the `cars` dataset to a variable:

```{r}
num_car_observations <- nrow(cars)
```

We might then write:\
"In the `cars` dataset, we have ``` ``r ''`r num_car_observations` ``` observations."

Which would output:\
"In the `cars` dataset, we have `r num_car_observations` observations."

## Executable code in other languages than R

If you want to use other languages than R, such as Python, Julia C++, or SQL, see [the relevant section of the *R Markdown Cookbook*](https://bookdown.org/yihui/rmarkdown-cookbook/other-languages.html)
